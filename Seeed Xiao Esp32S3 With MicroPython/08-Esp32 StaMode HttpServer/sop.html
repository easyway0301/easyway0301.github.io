<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>ESP32 StaMode HTTP Server SOP</title>

<style>
  body {
      font-family: Arial, "Microsoft JhengHei", sans-serif;
      line-height: 1.9;
      max-width: 980px;
      margin: 40px auto;
      padding: 0 20px;
      color: #222;
      background-color: #f5f7fa;
  }
  h1 { text-align: center; margin-bottom: 10px; }
  .subtitle { text-align: center; color: #555; margin-bottom: 40px; }
  section {
      background: #ffffff;
      border-radius: 14px;
      padding: 36px;
      margin-bottom: 50px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  }
  h2 { margin-top: 0; border-left: 6px solid #4caf50; padding-left: 14px; }
  p { margin: 14px 0; }
  ul { margin-left: 22px; }
  .greenbackground {
      background: #e8f5e9;
      border-left: 6px solid #4caf50;
      padding: 16px 20px;
      border-radius: 8px;
      margin: 20px 0;
  }
  .orangebackground {
      background: #fff3e0;
      border-left: 6px solid #ff9800;
      padding: 16px 20px;
      border-radius: 8px;
      margin: 20px 0;
  }
  .redbackground {
      background: #ffebee;
      border-left: 6px solid #f44336;
      padding: 16px 20px;
      border-radius: 8px;
      margin: 20px 0;
  }
  .code-block {
      position: relative;
      background: #0d1117;
      color: #c9d1d9;
      border-radius: 12px;
      padding: 20px;
      margin: 30px 0;
      font-family: Consolas, Monaco, monospace;
      font-size: 14px;
      overflow-x: auto;
  }
  .code-block pre {
      margin: 0;
      white-space: pre;
  }
  .copy-btn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #1f6feb;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 6px 14px;
      cursor: pointer;
      font-size: 13px;
  }
  .copy-btn:hover { background: #388bfd; }
</style>

<script>
function copyCode(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code).then(() => {
        btn.innerText = "Copied!";
        setTimeout(() => btn.innerText = "Copy", 1200);
    });
}
</script>
</head>
<body>

<h1>ESP32 StaMode HTTP Server</h1>
<p class="subtitle">ä½¿ç”¨ MicroPython åœ¨ Station æ¨¡å¼ä¸‹å»ºç«‹ HTTP ä¼ºæœå™¨</p>

<section>
  <h2>ğŸ“Œ èªªæ˜</h2>
  <p>
    æœ¬ç¯„ä¾‹ç¤ºç¯„å¦‚ä½•è®“ ESP32-S3 ä»¥ Stationï¼ˆSTAï¼‰æ¨¡å¼é€£æ¥æ—¢æœ‰ Wi-Fiï¼Œä¸¦å•Ÿå‹•ç°¡æ˜“ HTTP Serverã€‚
  </p>
  <ul>
    <li>é€£æ¥å®¶åº­æˆ–è¾¦å…¬ç„¡ç·šç¶²è·¯ï¼ˆSSID + Passwordï¼‰</li>
    <li>å»ºç«‹ socket ä¼ºæœå™¨ç­‰å¾… TCP é€£ç·š</li>
    <li>æ”¶åˆ°è«‹æ±‚å¾Œå›å‚³ç°¡å–®çš„ HTTP å›æ‡‰</li>
  </ul>
  <div class="orangebackground">
    ğŸ“Œ æ³¨æ„ï¼šç¢ºä¿ SSID èˆ‡å¯†ç¢¼å¡«å¯«æ­£ç¢ºï¼Œä¸”è¨­å‚™èƒ½æ¥æ”¶åˆ° Wi-Fi è¨Šè™Ÿã€‚
  </div>
</section>

<section>
  <h2>ğŸ“¶ Station é€£ç·šè¨­å®š</h2>
  <p>è«‹ä¿®æ”¹ä¸‹é¢è®Šæ•¸ä»¥é…åˆä½ çš„ Wi-Fi ç¶²è·¯ï¼š</p>
  <ul>
    <li><code>SSID</code> â†’ ç„¡ç·šç¶²è·¯åç¨±</li>
    <li><code>PASSWORD</code> â†’ è©²ç¶²è·¯å¯†ç¢¼</li>
  </ul>
</section>

<section>
  <h2>ğŸ’» å®Œæ•´ç¨‹å¼ç¢¼</h2>
  <div class="code-block">
    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
    <pre><code>
import network          # åŒ¯å…¥ Wi-Fi æ¨¡çµ„
import socket           # åŒ¯å…¥ socket æ¨¡çµ„
import time             # åŒ¯å…¥æ™‚é–“å»¶é²æ¨¡çµ„

# ===== Wi-Fi SSID / å¯†ç¢¼ =====
SSID = "ä½ çš„WiFiåç¨±"
PASSWORD = "ä½ çš„WiFiå¯†ç¢¼"

# å»ºç«‹ Station ä»‹é¢
sta = network.WLAN(network.STA_IF)
sta.active(True)
print("é–‹å§‹é€£ç·šè‡³ Wi-Fi:", SSID)

# é€£ç·š
sta.connect(SSID, PASSWORD)
while not sta.isconnected():
    print("é€£ç·šä¸­...")
    time.sleep(1)

print("å·²é€£ç·šï¼IP:", sta.ifconfig()[0])

# ===== å»ºç«‹ HTTP Server =====
addr = socket.getaddrinfo("0.0.0.0", 80)[0][-1]
s = socket.socket()
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind(addr)
s.listen(1)
print("HTTP Server å·²å•Ÿå‹•ï¼Œç›£è½ port 80")

try:
    while True:
        client, addr = s.accept()
        print("Client é€£ç·š:", addr)
        request = client.recv(1024).decode()
        print("æ”¶åˆ°:", request)

        # å›å‚³ HTTP Response
        response = "HTTP/1.1 200 OK\r\n\r\nHello from ESP32"
        client.send(response.encode())
        client.close()

except KeyboardInterrupt:
    print("åœæ­¢ä¼ºæœå™¨")

finally:
    s.close()
    sta.active(False)
    </code></pre>
  </div>
</section>

<section>
  <h2>ğŸ§ª æ¸¬è©¦æ–¹å¼</h2>
  <ol>
    <li>ä¸Šå‚³ç¨‹å¼åˆ° ESP32-S3 ä¸¦é‡æ–°å•Ÿå‹•</li>
    <li>ç­‰å¾…é€£ä¸Šä½ çš„ Wi-Fi</li>
    <li>åœ¨ç€è¦½å™¨ä¸­è¼¸å…¥é¡¯ç¤ºå‡ºçš„ IP</li>
    <li>é¡¯ç¤º â€œHello from ESP32â€ å³è¡¨ç¤ºæˆåŠŸ</li>
  </ol>
  <div class="greenbackground">
    âœ” è‹¥æˆåŠŸé€£ç·šï¼ŒESP32 å°‡æœƒåœ¨åºåˆ—åŸ å°å‡º IP ä½å€
  </div>
</section>

<section>
  <h2>âš  æ³¨æ„äº‹é …</h2>
  <ul>
    <li>è«‹ç¢ºä¿ç¶²è·¯å¯†ç¢¼æ­£ç¢ºç„¡èª¤</li>
    <li>Wi-Fi ç†±é»ä¸èƒ½è¨­ç½®æˆéš±è— SSID</li>
    <li>Server éœ€ç­‰å¾…ä¸¦è™•ç† client çš„ TCP è«‹æ±‚</li>
  </ul>
</section>

</body>
</html>
